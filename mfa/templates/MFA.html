{% extends "base.html" %}
{% load static %}
{% load i18n %}
{% block head %}
    <script src="{% static 'mfa/js/delete-token.js' %}"></script>
    <link href="{% static 'mfa/css/bootstrap-toggle.min.css' %}" rel="stylesheet">
    <script src="{% static 'mfa/js/bootstrap-toggle.min.js'%}"></script>
    <link href="{% static 'mfa/css/mfa.css' %}" rel="stylesheet">
{% endblock %}
{% block content %}
    <br/>
    <br/>
    <div class="container">
    <div class="row">
        <div>
            <div class="btn-group">
            <button class="btn btn-success dropdown-toggle" data-toggle="dropdown">
                {{transdict.add_method}}&nbsp;<span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                {% if not 'TOTP' in UNALLOWED_AUTHEN_METHODS %}
                    <li><a href="{% url 'start_new_otop' %}">{{transdict.auth_app}}</a></li>
                {% endif %}
                {% if not 'Email' in UNALLOWED_AUTHEN_METHODS %}
                    <li><a href="{% url 'start_email' %}">{{transdict.email_token}}</a></li>
                {% endif %}
                {% if not 'U2F' in UNALLOWED_AUTHEN_METHODS %}
                    <li><a href="{% url 'start_u2f' %}">{{transdict.security_key}}</a></li>
                {% endif %}
            {% if not 'FIDO2' in UNALLOWED_AUTHEN_METHODS %}
                    <li><a href="{% url 'start_fido2' %}">{{transdict.security_fido2_key}}</a></li>
                {% endif %}
            {% if not 'Trusted_Devices' in UNALLOWED_AUTHEN_METHODS %}
                    <li><a href="{% url 'start_td' %}">{{transdict.trusted_device}}</a></li>
                {% endif %}
            </ul>
            </div>
        </div>
    <br/>
    <br/>
       <table class="table table-striped">
           <tr>

               <th>{{transdict.type}}</th>
               <th>{{transdict.date_added}}</th>
               <th>{{transdict.expires_on}}</th>
               <th>{{transdict.device}}</th>
               <th>{{transdict.last_used}}</th>
               <th>{{transdict.status}}</th>
               <th>{{transdict.delete}}</th>
           </tr>
        {% for key in keys %}
           <tr>

               <td>{{ key.key_type }}</td>
               <td>{{ key.added_on }}</td>
               <td>{{ key.expires }}</td>
               <td>{% if key.device %}{{ key.device }}{% endif %}</td>
               <td>{{ key.last_used }}</td>
                {% if key.key_type in HIDE_DISABLE %}
                    <td>{% if key.enabled %}{{transdict.on}}{% else %}{{transdict.off}}{% endif %}</td>
                {% else %}
                    <td><input type="checkbox" id="toggle_{{ key.id }}" {% if key.enabled %}checked{% endif %} data-onstyle="success" data-offstyle="danger"  onchange="toggleKey({{ key.id }},'{% url 'toggle_key' %}?id={{key.id}}')" data-toggle="toggle" class="status_chk"></td>
                {% endif %}
               <td>{% if key.key_type in HIDE_DISABLE %}
                   ----
                   {% else %}
                    <form id="delete_form" action="" method="post">
                        {% csrf_token %}
                        <a href="#" value="{{ key.id }}", name="{{ key.key_type }}", url="{% url 'mfa_delKey' %}" id="delete-key-mfa"> <span class="fa fa-trash"></span></a></td>
                    </form> 
                    {% endif %}
           </tr>
       {% empty %}
           <tr><td colspan="7">{{transdict.no_keys_yet}}</td> </tr>
       {% endfor %}
        </table>
    </div>
    </div>
    {% include "modal.html" %}
{% endblock %}